<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secret Santa - Report Your Draw</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<body>
    <div class="container mt-5">
        <h1>Secret Santa Draw Reporting</h1>
        <p>Please enter the name(s) you were assigned in the original draw. This information is required to fix the assignments. Your previous pairings will be kept if you've already purchased a gift.</p>
        <form name="submissions" method="POST" action="/thank-you" data-netlify="true" data-netlify-honeypot="bot-field">
            <!-- This is a hidden field for Netlify's spam protection -->
            <input type="hidden" name="form-name" value="submissions" />
            <p class="hidden">
                <label>Don’t fill this out if you’re human: <input name="bot-field" /></label>
            </p>

            <div class="form-group">
                <label for="submitter-name">Your Name</label>
                <select class="form-control" id="submitter-name" name="submitter-name" required>
                    <option value="" disabled selected>Select your name</option>
                    <option>Robin</option>
                    <option>Steven</option>
                    <option>Emily</option>
                    <option>Erica</option>
                    <option>Rachael</option>
                    <option>Dave</option>
                    <option>Jan</option>
                </select>
            </div>
            <div class="form-group">
                <label for="submitter-email">Your Email</label>
                <input type="email" class="form-control" id="submitter-email" name="submitter-email" required>
                <small class="form-text text-muted">Your new assignment will be sent here.</small>
            </div>
            <hr>
            <h5>Assignment 1</h5>
            <div class="form-group">
                <label for="receiver-1-name">Who did you draw?</label>
                <select class="form-control" id="receiver-1-name" name="receiver-1-name" required>
                    <option value="" disabled selected>Select the person you drew</option>
                    <option>Robin</option>
                    <option>Steven</option>
                    <option>Emily</option>
                    <option>Erica</option>
                    <option>Rachael</option>
                    <option>Dave</option>
                    <option>Jan</option>
                </select>
            </div>
            <div class="form-check">
                <input type="checkbox" class="form-check-input" id="gift-purchased-1" name="gift-purchased-1" value="true">
                <label class="form-check-label" for="gift-purchased-1">I have already purchased a gift for this person.</label>
            </div>
            <hr>
            <h5>Assignment 2 (Optional)</h5>
            <p class="text-muted">If you were accidentally assigned a second person (like Erica), please enter their name below.</p>
            <div class="form-group">
                <label for="receiver-2-name">Who was the second person you drew?</label>
                <select class="form-control" id="receiver-2-name" name="receiver-2-name">
                    <option value="" disabled selected>Select the second person (if any)</option>
                    <option>Robin</option>
                    <option>Steven</option>
                    <option>Emily</option>
                    <option>Erica</option>
                    <option>Rachael</option>
                    <option>Dave</option>
                    <option>Jan</option>
                </select>
            </div>
            <div class="form-check">
                <input type="checkbox" class="form-check-input" id="gift-purchased-2" name="gift-purchased-2" value="true">
                <label class="form-check-label" for="gift-purchased-2">I have already purchased a gift for this second person.</label>
            </div>
            <hr>
            <button type="submit" class="btn btn-primary">Submit My Draw</button>
        </form>
    </div>

    <script>
      const handleSubmit = (event) => {
        event.preventDefault();
        
        const myForm = event.target;
        const formData = new FormData(myForm);
        
        fetch("/", {
          method: "POST",
          headers: { "Content-Type": "application/x-www-form-urlencoded" },
          body: new URLSearchParams(formData).toString(),
        })
        .then(() => window.location.href = '/thank-you')
        .catch((error) => alert(error));
      };
      
      document.querySelector("form").addEventListener("submit", handleSubmit);
    </script>
</body>
</html>
